#!/usr/bin/env bash
SCRIPTPATH="$( cd "$(dirname "$0")" ; pwd -P )"
if [[ $1 == "CLV_ENV_SETUP" ]]; then
    if [[ ! -e ~/.clv/bin/node ]]; then
        echo "clv is setting up environment for node"
        docker run --rm \
            -v "$HOME/.clv/root:/root" \
            -v "$PWD:/clv" \
            -w "/clv" \
            node npm config set prefix '/root/node'
        cp "$SCRIPTPATH/node" ~/.clv/bin/node
    fi
else
    docker run -it --rm \
        --network host \
        -e PATH="/root/node/bin:$PATH" \
        -v "$HOME/.clv/root:/root" \
        -v "$PWD:/clv" \
        -w "/clv" \
        -a STDOUT \
        node $@
fi

