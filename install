#!/usr/bin/env bash
SCRIPT_PATH="$( cd "$(dirname "$0")" ; pwd -P )"

# --- uninstall clv commands if any --- #
if [[ -e ~/.bash_profile ]] && grep -q "#ADDED BY CLV INSTALLER#" ~/.bash_profile; then
    "$SCRIPT_PATH"/uninstall bin
fi

# --- install clv --- #
mkdir -p ~/.clv/bin
if [[ -e ~/.clv.home.bak ]]; then
    echo "restoring clv's home directory"
    mv ~/.clv.home.bak ~/.clv/home
fi
touch ~/.bash_profile
export PATH="~/.clv/bin:$PATH"
echo "export PATH=\"~/.clv/bin:\$PATH\" #ADDED BY CLV INSTALLER#" > ~/.bash_profile
for cmd in "$SCRIPT_PATH"/bin/*; do
    "$cmd" clv-install
done

echo "clv has been installed successfully!"